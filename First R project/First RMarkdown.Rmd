---
title: "First Markdown"
output: html_document
date: '2022-06-09'
---
This is my first Markdown document

Shortcuts:

New code chunk: ctrl + alt + i
Knit: ctrl + shift + k
Run all chunks above current chunk: ctrl + alt + p
Run all chunks: ctrl + a + enter

Code Chunk Options:

echo = FALSE: Hide the code, but run code and produce all outputs, plots, warnings and messages.
eval = FALSE: Show code, but do not evaluate it.
fig.show = “hide”: Hides plots.
include = FALSE: Runs code, but suppresses all output. This is helpful for setup code. You can see an example of this in the first code chunk when you open a new R Markdown document!
message = FALSE: Prevent packages from printing messages when they load. This also suppress messages generated by functions.
results = "hide": Hides printed output.
warning = FALSE: Prevents packages and functions from displaying warnings.

#### **Let's load some libraries first**
#change
another change
here is another change

```{r libraries, echo = FALSE, warning = FALSE, message = FALSE}

  #library(tidyverse)
  #library(pastecs)

  library(pacman)
  p_load(tidyverse, pastecs, ggplot2, patchwork, knitr)

```

#### Next let's load the data

```{r}
  
        library(readxl)
        Mammogram <- read_excel("C:/Users/anjay/Downloads/Mammogram.xlsx")
        library(knitr)
        attach(Mammogram)
    

```

#### Let's look at the data for Mammogram

```{r}
  
  glimpse(Mammogram)  



  
  Mammogram <- Mammogram %>% mutate(menopa_cat = if_else(menopa == 0, "No", "Yes"))
  
  Mammogram %>% select(menopa_cat) %>% count(menopa_cat)
  
  prop.table(table(Mammogram$menopa_cat))
  
  kable(stat.desc(age), col.names = "age")
  
  prop <- prop.table(table(Mammogram$menopa_cat, cancer))
  
  prop
  
  windows.options(antialias = "cleartype")

  
  Mammogram %>% group_by(cancer) %>% summarize(freq = n()) %>% mutate(rel.freq = freq/sum(freq))
```

### Let's also make a section of code for tinkering



Worksheet for ACD Module 3
[Worksheet](https://wustl.instructure.com/courses/88393/files/4776714?module_item_id=1343688)
```{r Worksheet}
Mammogram %>% select(age) %>% summarize("Mean Age" = mean(age), "SD Age" = sd(age))
Mammogram <- Mammogram %>% mutate(cancer_cat = if_else(cancer == 1, "Cancer", "No CA"))
menopa_cancer_table <- table(Mammogram$menopa_cat, Mammogram$cancer_cat)


str(Mammogram)

Mammogram$menopa_cat <- as.character(Mammogram$menopa_cat)
Mammogram$cancer_cat <- as.character(Mammogram$cancer_cat)


colnames(menopa_cancer_table) <- c("menopa", "cancer")



library(gmodels)

kable(CrossTable(Mammogram$menopa_cat, Mammogram$cancer_cat))


library(gtsummary)

Mammogram %>% tbl_cross(row = menopa_cat, col = cancer, percent = "col", digits = c(0,2), label = list(menopa_cat ~ "Menopause Status", cancer ~ "Cancer")) %>% add_p() %>% bold_labels() %>% italicize_levels()

Mammogram %>% select(menopa_cat, cancer) %>% tbl_summary()

Mammogram <- Mammogram %>% mutate(fmh_cat = if_else(fmh == 1, "History of Cancer", "No History of Cancer"))

str(Mammogram)

Mammogram$fmh_cat = as.character(Mammogram$fmh_cat)

table(Mammogram$fmh_cat)

Mammogram %>% tbl_cross(row = fmh_cat, col = cancer_cat, percent = "col", digits = c(0,1))

Mammogram <- Mammogram %>% mutate(side1a_cat = if_else(side1a == 0, "none", if_else(side1a == 1, "Right", if_else(side1a == 2, "Left", if_else(side1a == 3, "Bilat", "Error")))))

Mammogram <- Mammogram %>% mutate(side1b_cat = if_else(side1b == 0, "none", if_else(side1b == 1, "Right", if_else(side1b == 2, "Left", if_else(side1b == 3, "Bilat", "Error")))))

Mammogram %>% filter(side1a_cat != "none" & side1b_cat != "none") %>%  tbl_cross(row = side1a_cat, col = side1b_cat, percent = "cell", digits = c(0,1))

Mammogram <- Mammogram %>% mutate(find1a_cat = if_else(find1a == 0, "Normal", if_else(find1a == 1, "Abn_ben", if_else(find1a == 2, "Indeterm", if_else(find1a == 3, "Susp", "Error")))))

Mammogram <- Mammogram %>% mutate(find2a_cat = if_else(find2a == 0, "Normal", if_else(find2a == 1, "Abn_ben", if_else(find2a == 2, "Indeterm", if_else(find2a == 3, "Susp", "Error")))))

Mammogram %>% filter(cancer_cat == "No CA") %>% tbl_cross(row = find1a_cat, col = find2a_cat, percent = "row", digits = c(0, 1))



library(flextable)

kappa_table <- Mammogram %>% filter(find1a_cat != "Unknown" & find2a_cat != "Unknown") %>% tbl_cross(row = find1a_cat, col = find2a_cat, percent = "cell", digits = c(0, 1))

library(psych)

library(vcd)

Kappa(table(Mammogram$find1a_cat, Mammogram$find2a_cat))

table(Mammogram$find1a_cat, Mammogram$find2a_cat)


Mammogram %>% select(find1a_cat, find2a_cat) %>% filter(find1a_cat != "Unknown" & find2a_cat != "Unknown") 


plot1 <- Mammogram %>% ggplot(aes(age, mammo)) + geom_point(color = 'steelblue')

plot2 <- Mammogram %>% ggplot(aes(age, color = mammo)) + geom_histogram(binwidth = 0.5)
plot1/plot2

TAB <- table(Mammogram$lump, Mammogram$cancer_cat)

chisq.test(TAB)

CHI <- chisq.test(TAB, correct = T)

attributes(CHI)

CHI$statistic

CHI$stdres

prop.test(TAB)


temp <- Mammogram %>% select(cancer_cat, find1a_cat, find2a_cat)

temp %>% na.omit() %>% tbl_cross(row=find1a_cat, col = find2a_cat, percent = "cell", digits = c(0, 1))

kappatab <- table(temp$find1a_cat, temp$find2a_cat)

cohen.kappa(kappatab)

Mammogram %>% filter((side1a_cat == "Left" | side1a_cat == "Right") & (side1b_cat == "Left" | side1b_cat == "Right")) %>% select(side1a_cat, side1b_cat) %>% tbl_cross(row = side1a_cat, col = side1b_cat, percent = "cell", digits = c(0,1))


temp2 <- Mammogram %>% filter((side1a_cat == "Left" | side1a_cat == "Right") & (side1b_cat == "Left" | side1b_cat == "Right")) %>% select(side1a_cat, side1b_cat)

kappatab2 <- table(temp2$side1a_cat, temp2$side1b_cat)

cohen.kappa(kappatab2)

describeFast(Mammogram)

stat.desc(Mammogram)




```

